<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Notes + Diary</title>
<style>
  :root{
    --bg:#fafbfc;--line:#e5e7eb;--muted:#6b7280;--ink:#111827;--ink-weak:#4b5563;
    --accent:#111827;--accent-ink:#fff;--danger:#dc2626;--danger-ink:#fff;
    --chip:#f3f4f6;
  }
  [data-theme="dark"]{
    --bg:#0b0f14;--line:#1f2937;--muted:#9ca3af;--ink:#e5e7eb;--ink-weak:#94a3b8;
    --accent:#3b82f6;--accent-ink:#fff;--danger:#ef4444;--danger-ink:#fff;
    --chip:#111827;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto}
  header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--line);background:#fff0;position:sticky;top:0;backdrop-filter:saturate(180%) blur(8px);z-index:3}
  h1{margin:0;font-size:18px}
  .tabs{display:flex;gap:8px}
  .tab{padding:6px 12px;border:1px solid var(--line);border-bottom:none;border-radius:8px 8px 0 0;background:var(--chip);cursor:pointer}
  .tab.active{background:#fff0;border-color:var(--ink);font-weight:600}
  .subbar{display:flex;gap:8px;align-items:center;justify-content:flex-end;color:var(--muted)}
  .app{display:grid;grid-template-columns:320px 1fr;min-height:calc(100vh - 54px)}
  .sidebar{border-right:1px solid var(--line);background:#fff0;display:flex;flex-direction:column;min-height:0}
  .toolbar{display:flex;gap:8px;padding:12px;border-bottom:1px solid var(--line)}
  .toolbar input{flex:1;padding:8px;border:1px solid var(--line);border-radius:8px;background:#fff0;color:var(--ink)}
  .toolbar button{padding:8px 10px;border:1px solid var(--line);background:var(--chip);border-radius:8px;cursor:pointer;color:var(--ink)}
  .list{overflow:auto}
  .item{padding:10px 12px;border-bottom:1px solid var(--line);cursor:pointer}
  .item.active{background:rgba(59,130,246,.12)}
  .item .title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .editor{padding:14px;display:flex;flex-direction:column;gap:8px}
  .path{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .path input{flex:1;min-width:220px;padding:8px;border:1px solid var(--line);border-radius:8px;background:#fff0;color:var(--ink)}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .btn{padding:8px 12px;border:1px solid var(--line);background:#fff0;border-radius:8px;cursor:pointer;color:var(--ink)}
  .btn.primary{background:var(--accent);color:var(--accent-ink);border-color:var(--accent)}
  .btn.danger{background:var(--danger);color:var(--danger-ink);border-color:var(--danger)}
  textarea{width:100%;height:60vh;padding:12px;border:1px solid var(--line);border-radius:10px;resize:vertical;background:#fff0;color:var(--ink)}
  .status{display:flex;gap:10px;align-items:center;color:var(--muted);font-size:12px;flex-wrap:wrap}
  .badge{border:1px solid var(--line);padding:2px 8px;border-radius:999px}
  .meta{display:flex;gap:8px;flex-wrap:wrap}
  .meta select,.meta input{padding:8px;border:1px solid var(--line);border-radius:8px;background:#fff0;color:var(--ink)}
  .rightbar{display:flex;gap:8px;align-items:center}
  .chip{padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:var(--chip);font-size:12px;color:var(--ink-weak)}

  /* Toast */
  #toast{position:fixed;right:16px;bottom:16px;padding:10px 14px;background:#111827;color:#fff;border-radius:10px;opacity:0;pointer-events:none;transition:.3s;z-index:50}
  #toast.show{opacity:1;transform:translateY(-6px)}

  /* ëª¨ë°”ì¼: ë¦¬ìŠ¤íŠ¸ ìœ„, ì—ë””í„° ì•„ë˜ */
  @media (max-width:900px){
    .app{grid-template-columns:1fr;gap:12px;padding:8px}
    .sidebar{border-right:none;border:1px solid var(--line);border-radius:10px;overflow:hidden}
    .editor{padding:8px}
  }
</style>
</head>
<body>
<header>
  <div style="display:flex;align-items:center;gap:12px;">
    <h1>ğŸ“ Notes + ğŸ“” Diary</h1>
    <div class="tabs">
      <div id="tabNotes" class="tab active">ë©”ëª¨</div>
      <div id="tabDiary" class="tab">ì¼ê¸°</div>
    </div>
  </div>
  <div class="rightbar">
    <span id="today" class="chip"></span>
    <button id="themeBtn" class="btn" title="ë‹¤í¬ëª¨ë“œ í† ê¸€">ğŸŒ“</button>
    <div class="subbar">
      <div id="dateBar" style="display:none;align-items:center;gap:6px;">
        <button id="prevDay" class="btn" title="ì´ì „">â†</button>
        <input id="datePicker" type="date"/>
        <button id="nextDay" class="btn" title="ë‹¤ìŒ">â†’</button>
      </div>
    </div>
  </div>
</header>

<div class="app">
  <aside class="sidebar">
    <!-- ë©”ëª¨ íˆ´ë°” -->
    <div class="toolbar" id="toolsNotes">
      <input id="searchNotes" placeholder="ë©”ëª¨ ê²€ìƒ‰(ì œëª©)"/>
      <button id="newNote" class="btn" title="ìƒˆ ë©”ëª¨ (Ctrl/Cmd+N)">ìƒˆ ë©”ëª¨</button>
    </div>
    <!-- ì¼ê¸° íˆ´ë°” -->
    <div class="toolbar" id="toolsDiary" style="display:none;">
      <input id="searchDiary" placeholder="ì´ ë‹¬ì˜ ì¼ê¸° ê²€ìƒ‰(ì œëª©)"/>
    </div>

    <!-- ê³µí†µ ë¦¬ìŠ¤íŠ¸ -->
    <div id="list" class="list"></div>
  </aside>

  <main class="editor">
    <div class="path">
      <input id="filename" placeholder="ê²½ë¡œ (ì˜ˆ: notes/inbox.md ë˜ëŠ” diary/2025/11/08.md)"/>
      <div class="actions">
        <button id="loadBtn" class="btn" title="ë¶ˆëŸ¬ì˜¤ê¸°">ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <button id="saveBtn" class="btn primary" title="ì €ì¥ (Ctrl/Cmd+S)">ì €ì¥</button>
        <button id="deleteBtn" class="btn danger" title="ì‚­ì œ (Ctrl/Cmd+Backspace)">ì‚­ì œ</button>
        <span id="saveState" class="badge">ëŒ€ê¸°</span>
      </div>
    </div>

    <!-- ì¼ê¸° ë©”íƒ€ -->
    <div id="metaDiary" class="meta" style="display:none;">
      <select id="mood">
        <option value="">ê¸°ë¶„</option>
        <option>ğŸ˜Š í–‰ë³µ</option><option>ğŸ˜Œ í¸ì•ˆ</option><option>ğŸ˜¥ ìš°ìš¸</option>
        <option>ğŸ˜¡ í™”ë‚¨</option><option>ğŸ˜µ í”¼ê³¤</option><option>ğŸ¤© ì‹ ë‚¨</option>
      </select>
      <select id="weather">
        <option value="">ë‚ ì”¨</option>
        <option>â˜€ï¸ ë§‘ìŒ</option><option>â›… ë¶€ë¶„ë§‘ìŒ</option><option>ğŸŒ§ï¸ ë¹„</option>
        <option>â›ˆï¸ ë‡Œìš°</option><option>ğŸŒ¨ï¸ ëˆˆ</option><option>ğŸŒ«ï¸ ì•ˆê°œ</option>
      </select>
      <input id="tags" placeholder="#íƒœê·¸,ì‰¼í‘œë¡œ êµ¬ë¶„"/>
    </div>

    <textarea id="editor" placeholder="ë‚´ìš©ì„ ì…ë ¥í•œ ë’¤ 'ì €ì¥'ì„ ëˆ„ë¥´ì„¸ìš”."></textarea>

    <div class="status">
      <span>ë¦¬í¬ì§€í† ë¦¬: <strong>kjd1374/notes</strong> | ë¸Œëœì¹˜: <strong>main</strong></span>
      <span id="info"></span>
    </div>
  </main>
</div>

<div id="toast"></div>

<script>
(function(){
  /* ===== ì„¤ì • ===== */
  const API = 'https://notes-api.rusilhurpe.workers.dev'; // â˜… ë³¸ì¸ Worker ì£¼ì†Œ

  /* ===== DOM ===== */
  const listEl = document.getElementById('list');
  const filenameEl = document.getElementById('filename');
  const editorEl = document.getElementById('editor');
  const loadBtn = document.getElementById('loadBtn');
  const saveBtn = document.getElementById('saveBtn');
  const deleteBtn = document.getElementById('deleteBtn');
  const saveState = document.getElementById('saveState');
  const info = document.getElementById('info');
  const todayEl = document.getElementById('today');
  const themeBtn = document.getElementById('themeBtn');

  const tabNotes = document.getElementById('tabNotes');
  const tabDiary = document.getElementById('tabDiary');
  const toolsNotes = document.getElementById('toolsNotes');
  const toolsDiary = document.getElementById('toolsDiary');

  const searchNotes = document.getElementById('searchNotes');
  const searchDiary = document.getElementById('searchDiary');
  const newNoteBtn = document.getElementById('newNote');

  const dateBar = document.getElementById('dateBar');
  const picker = document.getElementById('datePicker');
  const prevBtn = document.getElementById('prevDay');
  const nextBtn = document.getElementById('nextDay');
  const metaDiary = document.getElementById('metaDiary');
  const moodEl = document.getElementById('mood');
  const weatherEl = document.getElementById('weather');
  const tagsEl = document.getElementById('tags');

  /* ===== ìƒíƒœ ===== */
  let mode = 'notes'; // 'notes' | 'diary'
  let currentPath = '';
  let sha = null;
  let cacheList = [];
  let currentDate = new Date();
  let dirty = false;

  // ì˜¤ëŠ˜ í‘œì‹œ + í…Œë§ˆ
  const fmt = (d)=> d.getFullYear()+'-'+String(d.getMonth()+1).padStart(2,'0')+'-'+String(d.getDate()).padStart(2,'0');
  todayEl.textContent = fmt(new Date());
  picker.valueAsDate = currentDate;

  const savedTheme = localStorage.getItem('theme');
  if(savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);
  themeBtn.onclick = ()=>{
    const cur = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', cur);
    localStorage.setItem('theme', cur);
  };

  /* ===== Diary ê²½ë¡œ ===== */
  const monthDir = (d)=> `diary/${d.getFullYear()}/${String(d.getMonth()+1).padStart(2,'0')}`;
  const toDiaryPath = (d)=> `${monthDir(d)}/${String(d.getDate()).padStart(2,'0')}.md`;
  const pathToDate = (p)=>{ const m=p.match(/(\d{4})\/(\d{2})\/(\d{2})\.md$/); return m? new Date(+m[1],+m[2]-1,+m[3]) : new Date(); };

  /* ===== ì œëª© ìºì‹œ/ì¶”ì¶œ (ë¦¬ìŠ¤íŠ¸ ì œëª©ë§Œ í‘œì‹œ) ===== */
  const titleCache = new Map();
  function fallbackTitle(path){ const base = path.split('/').pop().replace(/\.md$/i,''); return base.replace(/[-_]+/g,' '); }
  async function getTitle(path){
    if (titleCache.has(path)) return titleCache.get(path);
    try{
      const r = await fetch(`${API}/load?path=${encodeURIComponent(path)}`);
      if(!r.ok){ const t=fallbackTitle(path); titleCache.set(path,t); return t; }
      const {content} = await r.json();
      let title = '';
      if(content){
        const lines = content.split(/\r?\n/);
        const h = lines.find(l=>/^#\s+/.test(l));
        title = h ? h.replace(/^#\s+/,'').trim() : (lines.find(l=>l.trim())||'').trim();
      }
      if(!title) title = fallbackTitle(path);
      if(title.length>80) title = title.slice(0,80)+'â€¦';
      titleCache.set(path,title);
      return title;
    }catch{
      const t=fallbackTitle(path); titleCache.set(path,t); return t;
    }
  }
  function updateTitleCacheFromEditor(path){
    const line = editorEl.value.split(/\r?\n/).find(l=>/^#\s+/.test(l));
    const title = (line ? line.replace(/^#\s+/, '').trim() : '') || titleCache.get(path) || fallbackTitle(path);
    titleCache.set(path, title);
  }

  /* ===== ëª©ë¡ ===== */
  async function loadList(){
    const dir = mode==='notes' ? 'notes' : monthDir(currentDate);
    const res = await fetch(`${API}/list?dir=${encodeURIComponent(dir)}`);
    if(!res.ok){ listEl.innerHTML=`<div class="item">ëª©ë¡ ì‹¤íŒ¨ ${res.status}</div>`; return; }
    cacheList = await res.json();
    renderList();
  }
  async function renderList(){
    const q = (mode==='notes' ? (searchNotes.value||'') : (searchDiary.value||'')).toLowerCase();
    listEl.innerHTML='';
    let items = cacheList.slice();
    items.sort((a,b)=> (mode==='notes' ? b.name.localeCompare(a.name) : a.name.localeCompare(b.name)));
    if(items.length===0){
      listEl.innerHTML = `<div class="item">${mode==='notes'?'ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤':'ì´ ë‹¬ì˜ ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤'}</div>`;
      return;
    }
    for(const it of items){
      const el = document.createElement('div');
      el.className = 'item' + (it.path===currentPath?' active':'');
      el.innerHTML = `<div class="title">ì œëª© ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>`;
      el.onclick = () => {
        if (mode==='notes') { filenameEl.value = it.path; doLoad(it.path); }
        else { openDiary(pathToDate(it.path)); }
      };
      listEl.appendChild(el);
      getTitle(it.path).then(title=>{
        if(q && !title.toLowerCase().includes(q)){ el.remove(); return; }
        el.querySelector('.title').textContent = title;
      });
    }
  }
  searchNotes.addEventListener('input', renderList);
  searchDiary.addEventListener('input', renderList);

  /* ===== ë„¤ë¹„/í† ìŠ¤íŠ¸ ===== */
  function toast(msg){ const t=document.getElementById('toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1400); }

  /* ===== ë¶ˆëŸ¬ì˜¤ê¸°/ì €ì¥/ì‚­ì œ ===== */
  loadBtn.onclick = ()=> doLoad(filenameEl.value.trim());
  saveBtn.onclick = ()=> doSave();
  deleteBtn.onclick = ()=> doDelete();

  async function doLoad(path){
    if(!path) return;
    info.textContent='ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';
    const res = await fetch(`${API}/load?path=${encodeURIComponent(path)}`);
    if(!res.ok){ info.textContent=`ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨ ${res.status}`; toast('ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨'); return; }
    const json = await res.json();
    editorEl.value = json.content || '';
    sha = json.sha || null;
    currentPath = path;
    dirty = false;
    saveState.textContent='ë¶ˆëŸ¬ì˜´';
    if(mode==='diary'){
      const c = editorEl.value;
      moodEl.value    = c.match(/mood:\s*(.*)/)?.[1]?.trim() || '';
      weatherEl.value = c.match(/weather:\s*(.*)/)?.[1]?.trim() || '';
      tagsEl.value    = c.match(/tags:\s*(.*)/)?.[1]?.trim() || '';
    }
    updateTitleCacheFromEditor(path);
    loadList();
    toast('ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤');
  }

  async function doSave(){
    const path = filenameEl.value.trim();
    if(!path){ alert('íŒŒì¼ ê²½ë¡œë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
    saveState.textContent='ì €ì¥ ì¤‘...';
    const res = await fetch(`${API}/save`,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ path, content: editorEl.value, sha })
    });
    if(!res.ok){ saveState.textContent=`ì €ì¥ ì‹¤íŒ¨ ${res.status}`; toast('ì €ì¥ ì‹¤íŒ¨'); return; }
    const json = await res.json();
    sha = json.sha || sha;
    dirty = false;
    saveState.textContent='ì €ì¥ë¨';
    info.textContent = `ì €ì¥: ${new Date().toLocaleTimeString()}`;
    updateTitleCacheFromEditor(path);
    if(!cacheList.some(x=>x.path===path)) loadList(); else renderList();
    toast('ì €ì¥ ì™„ë£Œ');
  }

  async function doDelete(){
    const path = filenameEl.value.trim();
    if(!path){ alert('ì‚­ì œí•  íŒŒì¼ ê²½ë¡œê°€ ì—†ìŠµë‹ˆë‹¤.'); return; }
    if(!sha){
      // shaê°€ ì—†ì„ ë•ŒëŠ” ìµœì‹  shaë¥¼ í•œë²ˆ ê°€ì ¸ì™€ì„œ ì‚­ì œ
      const r = await fetch(`${API}/load?path=${encodeURIComponent(path)}`);
      if(r.ok){ const j = await r.json(); sha = j.sha || sha; }
    }
    if(!sha){ alert('ì‚­ì œí•  íŒŒì¼ì„ ë¨¼ì € ë¶ˆëŸ¬ì˜¤ì„¸ìš”.'); return; }
    if(!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ì–´ìš”? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;

    const res = await fetch(`${API}/delete`,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ path, sha })
    });
    if(!res.ok){ toast('ì‚­ì œ ì‹¤íŒ¨'); return; }
    // UI ì´ˆê¸°í™”
    editorEl.value = '';
    filenameEl.value = '';
    sha = null; currentPath = '';
    saveState.textContent='ëŒ€ê¸°';
    toast('ì‚­ì œ ì™„ë£Œ');
    loadList();
  }

  // ë³€ê²½ ê°ì§€(ì´íƒˆ ê²½ê³ )
  editorEl.addEventListener('input', ()=>{ dirty=true; saveState.textContent='ìˆ˜ì •ë¨'; });
  window.addEventListener('beforeunload', (e)=>{ if(dirty){ e.preventDefault(); e.returnValue=''; } });

  /* ===== ë‹¨ì¶•í‚¤ ===== */
  document.addEventListener('keydown', (e)=>{
    const mod = e.metaKey || e.ctrlKey;
    if(mod && e.key.toLowerCase()==='s'){ e.preventDefault(); doSave(); }
    if(mod && e.key.toLowerCase()==='n'){ e.preventDefault(); newNote(); }
    if(mod && (e.key==='Backspace' || e.key==='Delete')){ e.preventDefault(); doDelete(); }
  });

  /* ===== ë©”ëª¨: ìƒˆ ë…¸íŠ¸ ===== */
  function newNote(){
    const now=new Date();
    const name = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}_${String(now.getHours()).padStart(2,'0')}${String(now.getMinutes()).padStart(2,'0')}.md`;
    const path = `notes/${name}`;
    filenameEl.value = path; currentPath=path; sha=null;
    editorEl.value = `# ${name.replace('.md','')}\n\n`;
    dirty=true; saveState.textContent='ìˆ˜ì •ë¨';
    titleCache.set(path, name.replace('.md',''));
    renderList();
    toast('ìƒˆ ë©”ëª¨ ì‹œì‘');
  }
  newNoteBtn.onclick = newNote;

  /* ===== ì¼ê¸° ===== */
  function diaryTemplate(date){
    const ymd = fmt(date);
    return `---
date: ${ymd}
mood: ${moodEl.value||''}
weather: ${weatherEl.value||''}
tags: ${tagsEl.value||''}
---

# ${ymd} ì¼ê¸°

ì˜¤ëŠ˜ì˜ í•œ ì¤„:
- 

ì˜¤ëŠ˜ ìˆì—ˆë˜ ì¼:
- 

ê°ì •/ìƒê°:
- 
`;
  }
  async function openDiary(date){
    currentDate = date;
    picker.valueAsDate = date;
    const path = toDiaryPath(date);
    filenameEl.value = path; currentPath = path;
    const res = await fetch(`${API}/load?path=${encodeURIComponent(path)}`);
    if(!res.ok){ info.textContent=`ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨ ${res.status}`; toast('ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨'); return; }
    const {content, sha:shaVal} = await res.json();
    sha=shaVal||null;
    if(!content){
      editorEl.value = diaryTemplate(date);
      dirty=true; saveState.textContent='ìˆ˜ì •ë¨';
    }else{
      editorEl.value = content;
      dirty=false; saveState.textContent='ë¶ˆëŸ¬ì˜´';
      const c = content;
      moodEl.value    = c.match(/mood:\s*(.*)/)?.[1]?.trim() || '';
      weatherEl.value = c.match(/weather:\s*(.*)/)?.[1]?.trim() || '';
      tagsEl.value    = c.match(/tags:\s*(.*)/)?.[1]?.trim() || '';
    }
    updateTitleCacheFromEditor(path);
    loadList();
  }
  prevBtn.onclick = ()=> openDiary(new Date(currentDate.getFullYear(),currentDate.getMonth(),currentDate.getDate()-1));
  nextBtn.onclick = ()=> openDiary(new Date(currentDate.getFullYear(),currentDate.getMonth(),currentDate.getDate()+1));
  picker.onchange   = ()=> openDiary(new Date(picker.value));

  [moodEl,weatherEl,tagsEl].forEach(el=> el.addEventListener('change', ()=>{
    if(mode!=='diary') return;
    let t=editorEl.value;
    t = /mood:\s*.*/.test(t)    ? t.replace(/mood:\s*.*/,'mood: '+(moodEl.value||''))       : t;
    t = /weather:\s*.*/.test(t) ? t.replace(/weather:\s*.*/,'weather: '+(weatherEl.value||'')) : t;
    if(/tags:\s*.*/.test(t)) t = t.replace(/tags:\s*.*/,'tags: '+(tagsEl.value||''));
    else t = t.replace(/---\n\n/,'---\n\ntags: '+(tagsEl.value||'')+'\n\n');
    editorEl.value = t; dirty=true; saveState.textContent='ìˆ˜ì •ë¨';
  }));

  /* ===== íƒ­ ì „í™˜ ===== */
  function switchTab(next){
    if(dirty && !confirm('ì €ì¥í•˜ì§€ ì•Šì€ ë³€ê²½ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤. ì „í™˜í•˜ì‹œê² ì–´ìš”?')) return;
    mode = next;
    tabNotes.classList.toggle('active', mode==='notes');
    tabDiary.classList.toggle('active', mode==='diary');
    toolsNotes.style.display = (mode==='notes')?'flex':'none';
    toolsDiary.style.display = (mode==='diary')?'flex':'none';
    dateBar.style.display    = (mode==='diary')?'flex':'none';
    metaDiary.style.display  = (mode==='diary')?'flex':'none';
    dirty = false;

    if(mode==='notes'){
      filenameEl.value='notes/inbox.md';
      doLoad('notes/inbox.md');
    }else{
      openDiary(currentDate);
    }
  }
  tabNotes.onclick = ()=> switchTab('notes');
  tabDiary.onclick = ()=> switchTab('diary');

  /* ===== ì‹œì‘: ë©”ëª¨ ê¸°ë³¸ ===== */
  switchTab('notes');
  loadList();
})();
</script>
</body>
</html>
